#!/usr/bin/env bash

# To stop if any command fails.
set -e

# To stop on unset variables.
set -u

# To be in project root.
cd "${0%/*}/.."

# To build app first.
source bin/build

# To start development server.
cp "src/_dist/static/VERSION/main.js" "dist/static/$VERSION/main.js"
sed -i "" "s/<head>/<head><script src=\"static\/$VERSION\/elm.js\"><\/script>/" dist/index.html
elm-live src/Main.elm --open --dir dist --hot -- --output="dist/static/$VERSION/elm.js"
